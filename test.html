<html>
<head>
<script src="http://kindohm.com/offtheair/audiolib.min.js"></script>
<script src="encoded.js"></script>
<script>
// Base64 encoded string loaded from an external js file as variable mySample       
// Decode the sample
var mySample = atob(encoded);

var tempo = 120,
    notesPerBeat = 4,
    tickCounter = 1,
    tick = 0,
    dev, sampler;

function audioCallback(buffer, channelCount){
    // Fill the buffer with the sampler output
    sampler.append(buffer, channelCount);
}

window.addEventListener('load', function(){
    // Create an instance of the AudioDevice class
    dev = audioLib.AudioDevice(audioCallback /* callback for the buffer fills */, 2 /* channelCount */);
    // Create an instance  of the Sampler class
    sampler = audioLib.Sampler(dev.sampleRate);
    // Load the sample to the sampler
    sampler.loadWav(mySample, true);

    // The addPreProcessing() method is called before .generate()
    sampler.addPreProcessing(function(){
        // Make tickCounter approach 1, and trigger sample when reached
        tickCounter = tickCounter + 1 / dev.sampleRate * tempo / 60;

        if (tickCounter >= 1){
            tickCounter = 0;
            // Trigger the sample at e if first note, otherwise at a
            this.noteOn(tick ? 140 : 860);
            tick = (tick + 1) % notesPerBeat;
        }
    });

}, true);
</script>
</head>
<body>
<h1>testing</h1>
</body>
</html>